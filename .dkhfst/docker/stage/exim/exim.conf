# Main configuration
primary_hostname = exim
daemon_smtp_ports = 25 : 465
tls_on_connect_ports = 465
local_interfaces = 0.0.0.0
tls_advertise_hosts = *
tls_verify_hosts = !*
tls_certificate = /home/exim/certs/exim.crt
tls_privatekey = /home/exim/certs/exim.key
acl_smtp_rcpt = acl_check_rcpt

# ----------------------------
# Access Control Lists
# ----------------------------
begin acl

acl_check_rcpt:
  # Accept relaying from localhost or Docker network
  accept  hosts = 127.0.0.1 : 0.0.0.0/0

# ----------------------------
# Routers
# ----------------------------

begin routers

smarthost_router:
  driver = manualroute
  domains = *
  transport = remote_smtp
  route_list = * mailpit::1025


# ----------------------------
# Transports
# ----------------------------
begin transports

remote_smtp:
  driver = smtp
  hosts_require_tls = mailpit
  tls_verify_hosts =
  tls_try_verify_hosts =

local_delivery:
  driver = appendfile
  directory = /var/mail/$local_part
  maildir_format = true
  delivery_date_add
  envelope_to_add
  return_path_add
